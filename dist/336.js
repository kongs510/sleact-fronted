(self.webpackChunkalecture=self.webpackChunkalecture||[]).push([[336],{9250:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(5692),l=n(8678),r=n(3046),o=n(3564),s=n(9669),i=n.n(s),c=n(7294),d=n(5977),p=n(9249),m=n(8100);const u=({show:e,onCloseModal:t,setShowInviteChannelModal:n})=>{const{workspace:s,channel:u}=(0,d.UO)(),[h,g,b]=(0,l.Z)(""),{data:x}=(0,m.ZP)("/api/users",o.Z),{revalidate:k}=(0,m.ZP)(x&&u?`/api/workspaces/${s}/channels/${u}/members`:null,o.Z),f=(0,c.useCallback)((e=>{e.preventDefault(),h&&h.trim()&&i().post(`/api/workspaces/${s}/channels/${u}/members`,{email:h}).then((()=>{k(),n(!1),b("")})).catch((e=>{var t;console.dir(e),p.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}),[h]);return c.createElement(a.Z,{show:e,onCloseModal:t},c.createElement("form",{onSubmit:f},c.createElement(r.__,{id:"member-label"},c.createElement("span",null,"채널 멤버 초대"),c.createElement(r.II,{id:"member",value:h,onChange:g})),c.createElement(r.zx,{type:"submit"},"초대하기")))}},5692:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(7753);const l=(0,a.Z)("div",{target:"e1yr9h8w1"})({name:"10w7pu7",styles:"position:fixed;text-align:center;left:0;bottom:0;top:0;right:0;z-index:1022;&>div{margin-top:200px;display:inline-block;width:440px;background:white;--saf-0:rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);box-shadow:0 0 0 1px var(--saf-0),0 4px 12px 0 rgba(0, 0, 0, 0.12);background-color:rgba(var(--sk_foreground_min_solid, 248, 248, 248), 1);border-radius:6px;user-select:none;max-width:440px;padding:30px 40px 0;z-index:1012;position:relative;}"}),r=(0,a.Z)("button",{target:"e1yr9h8w0"})({name:"19gmbxq",styles:"position:absolute;right:10px;top:6px;background:transparent;border:none;font-size:30px;cursor:pointer"});var o=n(7294);const s=({show:e,children:t,onCloseModal:n})=>{const a=(0,o.useCallback)((e=>{e.stopPropagation()}),[]);return e?o.createElement(l,{onClick:n},o.createElement("div",{onClick:a},o.createElement(r,{onClick:n},"×"),t)):null}},2951:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(6809),l=n.n(a),r=n(7294);const o={},s=e=>{console.log("rerender",e);const t=(0,r.useCallback)((()=>{e&&(o[e].disconnect(),delete o[e])}),[e]);return e?(o[e]||(o[e]=l().connect(`http://localhost:3095/ws-${e}`,{transports:["websocket"]})),[o[e],t]):[void 0,t]}},2867:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>T});var a=n(7753);const l=(0,a.Z)("button",{target:"e589ftg0"})("background:transparent;border:none;width:26px;height:26px;display:inline-flex;justify-content:center;align-items:center;color:white;margin-left:10px;cursor:pointer;",(({collapse:e})=>e&&"\n    & i {\n      transform: none;\n    }\n  "),";");var r=n(3564),o=n(7294),s=n(5977),i=n(3727),c=n(8100);const d=()=>{const{workspace:e}=(0,s.UO)(),t=(0,s.TH)(),{data:n,error:a,revalidate:d,mutate:p}=(0,c.ZP)("/api/users",r.Z,{dedupingInterval:2e3}),{data:m}=(0,c.ZP)(n?`/api/workspaces/${e}/channels`:null,r.Z),[u,h]=(0,o.useState)(!1),[g,b]=(0,o.useState)({}),x=(0,o.useCallback)((()=>{h((e=>!e))}),[]),k=(0,o.useCallback)((e=>()=>{b((t=>({...t,[e]:void 0})))}),[]);return(0,o.useEffect)((()=>{console.log("ChannelList: workspace 바꼈다",e,t.pathname),b({})}),[e,t]),o.createElement(o.Fragment,null,o.createElement("h2",null,o.createElement(l,{collapse:u,onClick:x},o.createElement("i",{className:"c-icon p-channel_sidebar__section_heading_expand p-channel_sidebar__section_heading_expand--show_more_feature c-icon--caret-right c-icon--inherit c-icon--inline","data-qa":"channel-section-collapse","aria-hidden":"true"})),o.createElement("span",null,"Channels")),o.createElement("div",null,!u&&(null==m?void 0:m.map((t=>{const n=g[`c-${t.id}`];return o.createElement(i.OL,{key:t.name,activeClassName:"selected",to:`/workspace/${e}/channel/${t.name}`,onClick:k(`c-${t.id}`)},o.createElement("span",{className:void 0!==n&&n>=0?"bold":void 0},"# ",t.name),void 0!==n&&n>0&&o.createElement("span",{className:"count"},n))})))))};var p=n(2951);const m=()=>{const{workspace:e}=(0,s.UO)(),{data:t,error:n,revalidate:a,mutate:d}=(0,c.ZP)("/api/users",r.Z,{dedupingInterval:2e3}),{data:m}=(0,c.ZP)(t?`/api/workspaces/${e}/members`:null,r.Z),[u]=(0,p.Z)(e),[h,g]=(0,o.useState)(!1),[b,x]=(0,o.useState)({}),[k,f]=(0,o.useState)([]),w=(0,o.useCallback)((()=>{g((e=>!e))}),[]),v=(0,o.useCallback)((e=>()=>{x((t=>({...t,[e]:0})))}),[]);return(0,o.useEffect)((()=>{console.log("DMList: workspace 바꼈다",e),f([]),x({})}),[e]),(0,o.useEffect)((()=>(null==u||u.on("onlineList",(e=>{f(e)})),()=>{null==u||u.off("onlineList")})),[u]),o.createElement(o.Fragment,null,o.createElement("h2",null,o.createElement(l,{collapse:h,onClick:w},o.createElement("i",{className:"c-icon p-channel_sidebar__section_heading_expand p-channel_sidebar__section_heading_expand--show_more_feature c-icon--caret-right c-icon--inherit c-icon--inline","data-qa":"channel-section-collapse","aria-hidden":"true"})),o.createElement("span",null,"Direct Messages")),o.createElement("div",null,!h&&(null==m?void 0:m.map((n=>{const a=k.includes(n.id),l=b[n.id]||0;return o.createElement(i.OL,{key:n.id,activeClassName:"selected",to:`/workspace/${e}/dm/${n.id}`,onClick:v(n.id)},o.createElement("i",{className:"c-icon p-channel_sidebar__presence_icon p-channel_sidebar__presence_icon--dim_enabled c-presence "+(a?"c-presence--active c-icon--presence-online":"c-icon--presence-offline"),"aria-hidden":"true","data-qa":"presence_indicator","data-qa-presence-self":"false","data-qa-presence-active":"false","data-qa-presence-dnd":"false"}),o.createElement("span",{className:l>0?"bold":void 0},n.nickname),n.id===(null==t?void 0:t.id)&&o.createElement("span",null," (나)"),l>0&&o.createElement("span",{className:"count"},l))})))))};var u=n(9250),h=n(5692),g=n(8678),b=n(3046),x=n(9669),k=n.n(x),f=n(9249);const w=({show:e,onCloseModal:t,setShowInviteWorkspaceModal:n})=>{const{workspace:a}=(0,s.UO)(),[l,i,d]=(0,g.Z)(""),{data:p}=(0,c.ZP)("/api/users",r.Z),{revalidate:m}=(0,c.ZP)(p?`/api/workspaces/${a}/members`:null,r.Z),u=(0,o.useCallback)((e=>{e.preventDefault(),l&&l.trim()&&k().post(`/api/workspaces/${a}/members`,{email:l}).then((e=>{m(),n(!1),d("")})).catch((e=>{var t;console.dir(e),f.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}),[a,l]);return o.createElement(h.Z,{show:e,onCloseModal:t},o.createElement("form",{onSubmit:u},o.createElement(b.__,{id:"member-label"},o.createElement("span",null,"이메일"),o.createElement(b.II,{id:"member",type:"email",value:l,onChange:i})),o.createElement(b.zx,{type:"submit"},"초대하기")))},v=(0,a.Z)("div",{target:"ejoa3oo1"})({name:"3nqusf",styles:"position:fixed;top:0;right:0;left:0;bottom:0;z-index:1000;&>div{position:absolute;display:inline-block;--saf-0:rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);box-shadow:0 0 0 1px var(--saf-0),0 4px 12px 0 rgba(0, 0, 0, 0.12);background-color:rgba(var(--sk_foreground_min_solid, 248, 248, 248), 1);border-radius:6px;user-select:none;min-width:360px;z-index:512;max-height:calc(100vh - 20px);color:rgb(29, 28, 29);}"}),E=(0,a.Z)("button",{target:"ejoa3oo0"})({name:"19gmbxq",styles:"position:absolute;right:10px;top:6px;background:transparent;border:none;font-size:30px;cursor:pointer"}),C=({children:e,style:t,show:n,onCloseModal:a,closeButton:l})=>{const r=(0,o.useCallback)((e=>{e.stopPropagation()}),[]);return n?o.createElement(v,{onClick:a},o.createElement("div",{style:t,onClick:r},l&&o.createElement(E,{onClick:a},"×"),e)):null};C.defaultProps={closeButton:!0};const Z=C,_=(0,a.Z)("div",{target:"ehdscrr13"})({name:"tjo4qw",styles:"float:right"}),y=(0,a.Z)("header",{target:"ehdscrr12"})({name:"fvf0bi",styles:"height:38px;background:#350d36;color:#ffffff;box-shadow:0 1px 0 0 rgba(255, 255, 255, 0.1);padding:5px;text-align:center"}),S=(0,a.Z)("img",{target:"ehdscrr11"})({name:"1ly4jlu",styles:"width:28px;height:28px;position:absolute;top:5px;right:16px"}),M=(0,a.Z)("div",{target:"ehdscrr10"})({name:"47px7v",styles:"display:flex;padding:20px;& img{display:flex;}&>div{display:flex;flex-direction:column;margin-left:10px;}& #profile-name{font-weight:bold;display:inline-flex;}& #profile-active{font-size:13px;display:inline-flex;}"}),P=(0,a.Z)("button",{target:"ehdscrr9"})({name:"bl1q1k",styles:"border:none;width:100%;border-top:1px solid rgb(29, 28, 29);background:transparent;display:block;height:33px;padding:5px 20px 5px;outline:none;cursor:pointer"}),$=(0,a.Z)("div",{target:"ehdscrr8"})({name:"36bnqj",styles:"display:flex;flex:1"}),I=(0,a.Z)("div",{target:"ehdscrr7"})({name:"17lvj7e",styles:"width:65px;display:inline-flex;flex-direction:column;align-items:center;background:#3f0e40;border-top:1px solid rgb(82, 38, 83);border-right:1px solid rgb(82, 38, 83);vertical-align:top;text-align:center;padding:15px 0 0"}),z=(0,a.Z)("nav",{target:"ehdscrr6"})({name:"2pkygn",styles:"width:260px;display:inline-flex;flex-direction:column;background:#3f0e40;color:rgb(188, 171, 188);vertical-align:top;& a{padding-left:36px;color:inherit;text-decoration:none;height:28px;line-height:28px;display:flex;align-items:center;&.selected{color:white;}}& .bold{color:white;font-weight:bold;}& .count{margin-left:auto;background:#cd2553;border-radius:16px;display:inline-block;font-size:12px;font-weight:700;height:18px;line-height:18px;padding:0 9px;color:white;margin-right:16px;}& h2{height:36px;line-height:36px;margin:0;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-size:15px;}"}),q=(0,a.Z)("button",{target:"ehdscrr5"})({name:"1rmthq7",styles:"height:64px;line-height:64px;border:none;width:100%;text-align:left;border-top:1px solid rgb(82, 38, 83);border-bottom:1px solid rgb(82, 38, 83);font-weight:900;font-size:24px;background:transparent;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding:0;padding-left:16px;margin:0;color:white;cursor:pointer"}),j=(0,a.Z)("div",{target:"ehdscrr4"})({name:"1146j5j",styles:"height:calc(100vh - 102px);overflow-y:auto"}),N=(0,a.Z)("div",{target:"ehdscrr3"})({name:"192o1ir",styles:"padding:10px 0 0;& h2{padding-left:20px;}&>button{width:100%;height:28px;padding:4px;border:none;background:transparent;border-top:1px solid rgb(28, 29, 28);cursor:pointer;&:last-of-type{border-bottom:1px solid rgb(28, 29, 28);}}"}),O=(0,a.Z)("div",{target:"ehdscrr2"})({name:"82a6rk",styles:"flex:1"}),U=(0,a.Z)("button",{target:"ehdscrr1"})({name:"9tlmej",styles:"color:white;font-size:24px;display:inline-block;width:40px;height:40px;background:transparent;border:none;cursor:pointer"}),A=(0,a.Z)("button",{target:"ehdscrr0"})({name:"wsqixl",styles:"display:inline-block;width:40px;height:40px;border-radius:10px;background:white;border:3px solid #3f0e40;margin-bottom:15px;font-size:18px;font-weight:700;color:black;cursor:pointer"});var D=n(2168),L=n(6182),W=n.n(L);const B=({show:e,onCloseModal:t,setShowCreateChannelModal:n})=>{const[a,l,i]=(0,g.Z)(""),{workspace:d,channel:p}=(0,s.UO)(),{data:m,error:u,revalidate:x}=(0,c.ZP)("/api/users",r.Z,{dedupingInterval:2e3}),{data:w,mutate:v,revalidate:E}=(0,c.ZP)(m?`/api/workspaces/${d}/channels`:null,r.Z),C=(0,o.useCallback)((e=>{e.preventDefault(),k().post(`/api/workspaces/${d}/channels`,{name:a},{withCredentials:!0}).then((e=>{n(!1),E(),i("")})).catch((e=>{var t;console.dir(e),f.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}),[a]);return o.createElement(h.Z,{show:e,onCloseModal:t},o.createElement("form",{onSubmit:C},o.createElement(b.__,{id:"channel-label"},o.createElement("span",null,"채널"),o.createElement(b.II,{id:"channel",value:a,onChange:l})),o.createElement(b.zx,{type:"submit"},"생성하기")))},F=(0,D.ZP)((()=>Promise.all([n.e(796),n.e(13),n.e(256)]).then(n.bind(n,5256)))),H=(0,D.ZP)((()=>Promise.all([n.e(796),n.e(13),n.e(94)]).then(n.bind(n,3094)))),T=()=>{const[e,t]=(0,o.useState)(!1),[n,a]=(0,o.useState)(!1),[l,x]=(0,o.useState)(!1),[v,E]=(0,o.useState)(!1),[C,D]=(0,o.useState)(!1),[L,T]=(0,o.useState)(!1),[G,J,K]=(0,g.Z)(""),[Q,R,V]=(0,g.Z)(""),{workspace:X}=(0,s.UO)(),{data:Y,error:ee,revalidate:te,mutate:ne}=(0,c.ZP)("/api/users",r.Z,{dedupingInterval:2e3}),{data:ae}=(0,c.ZP)(Y?`/api/workspaces/${X}/channels`:null,r.Z),{data:le}=(0,c.ZP)(Y?`/api/workspaces/${X}/members`:null,r.Z),[re,oe]=(0,p.Z)(X);(0,o.useEffect)((()=>{ae&&Y&&re&&(console.log(re),re.emit("login",{id:Y.id,channels:ae.map((e=>e.id))}))}),[re,ae,Y]),(0,o.useEffect)((()=>()=>{oe()}),[X,oe]);const se=(0,o.useCallback)((()=>{k().post("/api/users/logout",null,{withCredentials:!0}).then((()=>{ne(!1,!1)}))}),[]),ie=(0,o.useCallback)((e=>{e.stopPropagation(),t(!1)}),[]),ce=(0,o.useCallback)((()=>{t((e=>!e))}),[]),de=(0,o.useCallback)((()=>{a(!0)}),[]),pe=(0,o.useCallback)((e=>{e.preventDefault(),G&&G.trim()&&Q&&Q.trim()&&k().post("/api/workspaces",{workspace:G,url:Q},{withCredentials:!0}).then((()=>{te(),a(!1),K(""),V("")})).catch((e=>{var t;console.dir(e),f.Am.error(null===(t=e.response)||void 0===t?void 0:t.data,{position:"bottom-center"})}))}),[G,Q]),me=(0,o.useCallback)((()=>{a(!1),T(!1),x(!1),E(!1)}),[]),ue=(0,o.useCallback)((()=>{D((e=>!e))}),[]),he=(0,o.useCallback)((()=>{T(!0)}),[]),ge=(0,o.useCallback)((()=>{x(!0)}),[]);return Y?o.createElement("div",null,o.createElement(y,null,o.createElement(_,null,o.createElement("span",{onClick:ce},o.createElement(S,{src:W().url(Y.email,{s:"28px",d:"retro"}),alt:Y.nickname}),e&&o.createElement(Z,{style:{right:0,top:38},show:e,onCloseModal:ie},o.createElement(M,null,o.createElement("img",{src:W().url(Y.nickname,{s:"36px",d:"retro"}),alt:Y.nickname}),o.createElement("div",null,o.createElement("span",{id:"profile-name"},Y.nickname),o.createElement("span",{id:"profile-active"},"Active"))),o.createElement(P,{onClick:se},"로그아웃"))))),o.createElement($,null,o.createElement(I,null,null==Y?void 0:Y.Workspaces.map((e=>o.createElement(i.rU,{key:e.id,to:"/workspace/123/channel/일반"},o.createElement(A,null,e.name.slice(0,1).toUpperCase())))),o.createElement(U,{onClick:de},"+")),o.createElement(z,null,o.createElement(q,{onClick:ue},"Sleact"),o.createElement(j,null,o.createElement(Z,{show:C,onCloseModal:ue,style:{top:95,left:80}},o.createElement(N,null,o.createElement("h2",null,"Sleact"),o.createElement("button",{onClick:ge},"워크스페이스에 사용자 초대"),o.createElement("button",{onClick:he},"채널 만들기"),o.createElement("button",{onClick:se},"로그아웃"))),o.createElement(d,null),o.createElement(m,null))),o.createElement(O,null,o.createElement(s.rs,null,o.createElement(s.AW,{path:"/workspace/:workspace/channel/:channel",component:F}),o.createElement(s.AW,{path:"/workspace/:workspace/dm/:id",component:H})))),o.createElement(h.Z,{show:n,onCloseModal:me},o.createElement("form",{onSubmit:pe},o.createElement(b.__,{id:"workspace-label"},o.createElement("span",null,"워크스페이스 이름"),o.createElement(b.II,{id:"workspace",value:G,onChange:J})),o.createElement(b.__,{id:"workspace-url-label"},o.createElement("span",null,"워크스페이스 url"),o.createElement(b.II,{id:"workspace",value:Q,onChange:R})),o.createElement(b.zx,{type:"submit"},"생성하기"))),o.createElement(B,{show:L,onCloseModal:me,setShowCreateChannelModal:T}),o.createElement(w,{show:l,onCloseModal:me,setShowInviteWorkspaceModal:x}),o.createElement(u.Z,{show:v,onCloseModal:me,setShowInviteChannelModal:E})):o.createElement(s.l_,{to:"/login"})}},418:()=>{}}]);